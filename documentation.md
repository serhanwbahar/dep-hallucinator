# Dep-Hallucinator Documentation

Security scanner that detects AI-generated dependency confusion vulnerabilities in software projects.

## Description

`dep-hallucinator` identifies dependency confusion vulnerabilities caused by AI-generated package recommendations. AI code assistants sometimes suggest packages that don't exist, creating an opportunity for attackers to register malicious packages with the same names.

### Features

* **Multi-Ecosystem Support**: Scans Python, JavaScript, Java, Rust, and Go dependency files
* **Registry Existence Check**: Identifies non-existent packages (flagged as CRITICAL vulnerabilities)
* **Heuristic Analysis**: Analyzes package metadata including age, download count, and naming patterns
* **Machine Learning Detection**: Uses ML models to identify AI-generated naming patterns
* **Risk Classification**: Assigns CRITICAL, HIGH, MEDIUM, or LOW risk levels
* **CI/CD Integration**: Configurable exit codes for automated pipelines
* **Multiple Output Formats**: Console and JSON output formats
* **SBOM Generation**: Creates Software Bill of Materials in SPDX and CycloneDX formats
* **Transitive Dependency Scanning**: Resolves and scans dependencies of dependencies
* **Signature Verification**: Verifies package signatures using modern standards

### License

MIT License

## Installation

### Requirements

* **Python**: 3.8 or newer
* **Platform**: Cross-platform (Windows, macOS, Linux)

### Supported Ecosystems

| Language   | Registry      | File Types                                    |
|------------|---------------|-----------------------------------------------|
| Python     | PyPI          | `requirements.txt`, `poetry.lock`, `Pipfile.lock` |
| JavaScript | npm           | `package.json`, `yarn.lock`                  |
| Java       | Maven Central | `pom.xml`, `build.gradle`, `build.gradle.kts` |
| Rust       | Crates.io     | `Cargo.toml`, `Cargo.lock`                   |
| Go         | Go Modules    | `go.mod`, `go.sum`                           |

### Installation from PyPI

```bash
pip install dep-hallucinator
```

### Development Installation

```bash
git clone https://github.com/serhanwbahar/dep-hallucinator.git
cd dep-hallucinator
python -m venv .venv
source .venv/bin/activate
pip install -e ".[dev,test]"
make test
```

## Usage

### Basic Commands

```bash
# Basic scan
dep-hallucinator scan requirements.txt

# Scan with JSON output
dep-hallucinator scan requirements.txt --output-format json --output-file results.json

# Batch scan multiple files
dep-hallucinator batch requirements.txt package.json pom.xml

# Quiet mode for CI/CD
dep-hallucinator scan requirements.txt --quiet
```

### Command Reference

#### `scan` - Scan single dependency file

```bash
dep-hallucinator scan <FILE_PATH> [OPTIONS]
```

**Key Options:**
* `--rate-limit <float>` - API requests per second (default: 10.0)
* `--max-concurrent <int>` - Max concurrent checks (default: 20)
* `--output-format <console|json>` - Output format
* `--output-file, -o <path>` - Save results to file (JSON only)
* `--quiet, -q` - Suppress non-critical output
* `--verbose, -v` - Enable verbose output
* `--fail-on-high` - Exit with error on HIGH risk packages
* `--resolve-transitive` - Scan transitive dependencies
* `--verify-signatures` - Verify package signatures
* `--generate-sbom` - Generate Software Bill of Materials
* `--sbom-format <spdx|cyclonedx>` - SBOM format (default: spdx)

#### `batch` - Scan multiple files

```bash
dep-hallucinator batch <FILES...> [OPTIONS]
```

* `--output-dir <path>` - Directory for result files (JSON format)

#### `config` - Configuration management

```bash
dep-hallucinator config init [--path <path>] [--force]
dep-hallucinator config show
dep-hallucinator config validate <config_file>
```

#### `cache` - Cache management

```bash
dep-hallucinator cache stats
dep-hallucinator cache clear
dep-hallucinator cache entries [--limit <n>]
```

#### Other Commands

* `info` - Show supported file types and usage examples
* `completion <shell>` - Generate shell completion scripts

### Example Output

```
üîç Scanning 8 dependencies...

üìä Scan Summary           
üö® CRITICAL ‚îÇ   2   ‚îÇ VULNERABLE
üî∂ HIGH     ‚îÇ   1   ‚îÇ SUSPICIOUS  
‚úÖ LOW      ‚îÇ   5   ‚îÇ     OK     

üö® CRITICAL VULNERABILITIES

üì¶ ai-powered-data-processor (==1.0.0)
   Suspicion Score: 100% (CRITICAL) | ML: 95%
   Reasons:
   ‚Ä¢ Package does not exist in the registry
   ‚Ä¢ Vulnerable to dependency confusion attacks
   Recommendations:
   ‚Üí Do not install this package
   ‚Üí Check if this was generated by an AI assistant
```

### Configuration

Create `.dep-hallucinator.json`:

```json
{
  "scan": {
    "rate_limit": 10.0,
    "max_concurrent": 20,
    "timeout_seconds": 30,
    "fail_on_high": false
  },
  "security": {
    "max_file_size_mb": 10
  }
}
```

### Exit Codes

* `0` - No critical vulnerabilities found
* `1` - Critical vulnerabilities found  
* `130` - Scan interrupted by user

## Additional Documentation

This repository includes several specialized documentation files:

* **[README.md](README.md)** - Quick start guide and overview
* **[security.md](security.md)** - Security policy and vulnerability reporting
* **[contributing.md](contributing.md)** - Development guidelines and contribution process
* **[deployment.md](deployment.md)** - Basic deployment and CI/CD integration
* **[production_deployment.md](production_deployment.md)** - Production deployment configurations
* **[release_notes.md](release_notes.md)** - Version 1.0.0 features and changes
* **[branching_strategy.md](branching_strategy.md)** - Git workflow and branch management
* **[structured_logging.md](structured_logging.md)** - JSON logging for SIEM integration